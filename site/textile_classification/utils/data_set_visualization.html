<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Data_Set_Visualization - Home</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Data_Set_Visualization";
        var mkdocs_page_input_path = "textile_classification\\utils\\data_set_visualization.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../index.html" class="icon icon-home"> Home
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Textile Classification</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../train.html">Train</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../test.html">Test</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../predict.html">Predict</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Data_Setters</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../data_setters/create_csv_files.html">Create_CSV_Files</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../data_setters/data_set_creator.html">Data_Set_Creator</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Models</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../models/pretrained_densenet.html">DenseNet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../models/pretrained_efficientnet.html">EfficientNet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../models/pretrained_resnext.html">ResNeXt</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Utils</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="data_set_visualization.html">Data_Set_Visualization</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="metric_calculation_visualization.html">Metric_Calculation_Visualization</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="miscellaneous.html">miscellaneous</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="model_tracking.html">model_tracking</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Home</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html" class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Textile Classification &raquo;</li>
          <li>Utils &raquo;</li>
      <li>Data_Set_Visualization</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/srahmatian/texture_classification/edit/master/docs/textile_classification/utils/data_set_visualization.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">


<a id="textile_classification.utils.data_set_visualization"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="textile_classification.utils.data_set_visualization.plot_images" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_images</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">labels_grnd_truth</span><span class="p">,</span> <span class="n">labels_predicted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>It takes a bunch of images and show them with their ground truth lable on the x-axis, 
and predicted labelon the y-axis.
If the prediction is correct, we show the prediction in green, otherwise in red.
If you want to show images, and you do not have the predictions yet, 
just left it unassigned.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>images</code></td>
          <td>
                <code>torch.<span title="torch.Tensor">Tensor</span></code>
          </td>
          <td><p>a pytorch tensor in the shape of (batch_size, 3, height, width)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>labels_grnd_truth</code></td>
          <td>
                <code>torch.<span title="torch.Tensor">Tensor</span></code>
          </td>
          <td><p>a pytorch tensor in the shape of (batch_size, )</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>labels_predicted</code></td>
          <td>
                <code>torch.<span title="torch.Tensor">Tensor</span></code>
          </td>
          <td><p>a pytorch tensor in the shape of (batch_size, )
                             it doesn't matter if labels_predicted are in probability or deterministic forrmat. </p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="matplotlib.pyplot">plt</span>.<span title="matplotlib.pyplot.figure">figure</span></code>
          </td>
          <td><p>plt.figure: It return the figure, so you can save or use it in another place.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>textile_classification\utils\data_set_visualization.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_images</span><span class="p">(</span><span class="n">images</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> 
                <span class="n">labels_grnd_truth</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> 
                <span class="n">labels_predicted</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It takes a bunch of images and show them with their ground truth lable on the x-axis, </span>
<span class="sd">    and predicted labelon the y-axis.</span>
<span class="sd">    If the prediction is correct, we show the prediction in green, otherwise in red.</span>
<span class="sd">    If you want to show images, and you do not have the predictions yet, </span>
<span class="sd">    just left it unassigned.</span>

<span class="sd">    Args:</span>
<span class="sd">        images (torch.Tensor): a pytorch tensor in the shape of (batch_size, 3, height, width)</span>
<span class="sd">        labels_grnd_truth (torch.Tensor): a pytorch tensor in the shape of (batch_size, )</span>
<span class="sd">        labels_predicted (torch.Tensor): a pytorch tensor in the shape of (batch_size, )</span>
<span class="sd">                                         it doesn&#39;t matter if labels_predicted are in probability or deterministic forrmat. </span>

<span class="sd">    Returns:</span>
<span class="sd">        plt.figure: It return the figure, so you can save or use it in another place.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># assert the input tensors are in the shape of having batch_size.</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">images</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span><span class="p">),</span> <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;input images must be a tensor having 4 dimensions&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">labels_grnd_truth</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;input labels_grnd_truth must be a tensor having 1 dimension&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">labels_predicted</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">labels_predicted</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;input labels_predicted must be a tensor having 1 dimension&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">),</span> <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;input images must have three channels&quot;</span><span class="p">)</span>

    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># or labels_ground_truth.shape[0], or labels_predicted.shape[0]</span>
    <span class="n">num_columns</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">num_rows</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">batch_size</span> <span class="o">/</span> <span class="n">num_columns</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">batch_size</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>    
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">num_columns</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num_columns</span> <span class="o">*</span> <span class="n">num_rows</span><span class="p">))</span>
    <span class="c1"># note that the indices in fig.add_subplot must start from 1 not 0.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">num_columns</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">xticks</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">yticks</span> <span class="o">=</span> <span class="p">[])</span>
        <span class="c1"># Remember we have transformed images from PIL (H, W, C) to Tensor (C, H, W), </span>
        <span class="c1"># We need to convert back its shape to be able of showing it using matplotlib.</span>
        <span class="n">each_image</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">each_image</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LABELS_INT_To_STR</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">labels_grnd_truth</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">labels_predicted</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels_predicted</span> <span class="o">=</span> <span class="n">change_labels_from_probablity_format_to_deterministic_format</span><span class="p">(</span>
                <span class="n">labels_predicted</span><span class="p">,</span>
                <span class="n">is_one_hot_format</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span>
            <span class="k">if</span> <span class="n">labels_predicted</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">labels_grnd_truth</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LABELS_INT_To_STR</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">labels_predicted</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../models/pretrained_resnext.html" class="btn btn-neutral float-left" title="ResNeXt"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="metric_calculation_visualization.html" class="btn btn-neutral float-right" title="Metric_Calculation_Visualization">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/srahmatian/texture_classification" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../models/pretrained_resnext.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="metric_calculation_visualization.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
